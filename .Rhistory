setwd("~/Projects/pos-cd-e-mc")
library(readr)
# Associacao do arquivo com a tabela4
tabela4 <- read_csv('tabela_4A.csv')
View(tabela4)
# criacao de uma coluna (vetor) com a media das velocidades dos intervalos
tabela4$media_velocidades <- c(19/2, (29+20)/2,(39+30)/2, (49+40)/2, (59+50)/2, (69+60)/2, (79+70)/2,(89+80)/2, (99+90)/2, (109+100)/2, (119+110)/2, (129+120)/2, (139+130)/2, (199+140)/2)
# contagem do numero de linhas da tabela na variavel nlinhas
nlinhas <- nrow(tabela4);nlinhas
# criacao da coluna que representa o  somatario da frequencia vezes a media das velocidades
tabela4$SomavFreq <- 0
for(i in 1:nlinhas){tabela4$SomavFreq[i] <- sum(tabela4$'jan/17'[i]*tabela4$media_velocidades[i])}
# soma de todas as frequencias, representando o numero N
Njan17 = sum(tabela4$'jan/17')
# Calculo da media das frequencias
Media_Jan17 = sum(tabela4$SomavFreq)/Njan17;Media_Jan17
# Soma ao quadrado dos erros
tabela4$SS <- 0
for(i in 1:nlinhas){tabela4$SS[i] <- sum((tabela4$media_velocidades[i] - Media_Jan17)^2*tabela4$'jan/17'[i])}
# variancia
variancia <- sum(tabela4$SS)/(Njan17-1);variancia
# desvio padrao
desvio_padrao <- sqrt(variancia) ;desvio_padrao
#gráfico
faixas <- c("1-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-109","110-119","120-129","130-139","140-199")
barplot(tabela4$'jan/17', main = "Distribuicao de velocidades",xlab = "Faixa de Velocidades (km/h)",ylab="Frequencia",col="darkred",names.arg = faixas)
library(readr)
#Carrega a tabela de balas
tabela_balas <- read.csv2("tabela_balas.csv")
#sumário da tabela
summary(tabela_balas)
#cria a coluna media comerciais
tabela_balas$media_comerciais <- mean(tabela_balas$Comerciais.assistidos)
#cria a coluna media pacotes
tabela_balas$media_pacotes <- mean(tabela_balas$Pacotes.comprados)
#cria a coluna desvio-padrão para os comerciais
tabela_balas$desvio_comerciais <- sd(tabela_balas$Comerciais.assistidos)
#cria a coluna desvio-padrão para os pacotes
tabela_balas$desvio_pacotes <- sd(tabela_balas$Pacotes.comprados)
# cria o GRÁFICO com os dados as médias
plot(tabela_balas$Pacotes, type = "p", pch = 16, cex = 2, xlab = "Pessoas", ylab="Número de pacotes/comerciais", ylim=c(0,16), col="darkred")
par(new = TRUE)
plot(tabela_balas$Comerciais.assistidos, type = "p", pch = 15, cex = 2, xlab = NA, ylab = NA, ylim=c(0,16), col="#69b3a2")
par(new = TRUE)
plot(tabela_balas$media_comerciais, type = "l", lty = 2, xlab = NA, ylab = NA,  ylim=c(0,16), col="#69b3a2")
par(new = TRUE)
plot(tabela_balas$media_pacotes, type = "l", lty = 2, xlab = NA, ylab = NA, ylim=c(0,16), col="darkred")
legend(1, 16, legend=c("Pacotes", "Comerciais"),col=c("darkred", "#69b3a2"), pch = 16:15, cex=1)
#faz a correlação entre as colunas da tabela. Veja que só os quatro primeiros importam
cor(tabela_balas, method = "pearson")
#-------- correlação entre peso e tamanho do cérebro em animais
library(MASS)
head(Animals)
cor(Animals, method = "pearson")
#-------- correlação entre dados de carros americanos
head(Cars93)
Motor_Consumo <- cor(Cars93$EngineSize, Cars93$MPG.city, method = "pearson")
Motor_potencia <- cor(Cars93$EngineSize, Cars93$Horsepower, method = "pearson")
Motor_Consumo^2
#faz o gráfico da distribuição normal utilizando a média e o desvio-padrão da tabela 4 de Jan17
x <- seq(0,200, by = 1)
y <- dnorm(x, mean = 69.3093, sd = 6.4445)
plot(x,y, xlab = NA ,ylab= NA, type = 'l', col = 'darkgreen')
#a variável z é a padronização dos valores do eixo horizontal
z <-  c((x - Media_Jan17)/desvio_padrao)
#curva normal padronizada com média zero e desvio 1
y2 <- dnorm(z, mean = 0, sd = 1)
plot(z,y2,type="l",lwd=2,col='darkred')
#definimos a velocidade a ser analisada
velocidade <- 60
#pegamos a média da distribuição dos nossos dados
Media = 69.3093
#pegamos também o desvio-padrão dos dados
desvio_padrao = 6.4445
#E agora temos o valor numérico da probabilidade. A resposta sai no terminal abaixo
pnorm(velocidade, mean = Media, sd = desvio_padrao)
#Para fazer um gráfico que mostra todas as velocidades abaixo de 70km/h
z1 <- (velocidade - Media_Jan17)/6.44
x=seq(-4,4,length=200)
y=dnorm(x)
plot(x,y,type="l", lwd=4, col="darkred")
x=seq(-4,z1,length=200)
y=dnorm(x)
polygon(c(-4,x,z1),c(0,y,0),col="gray")
(readr)
(readr)
(readr)
(readr)
(readr)
#Associando o arquivo tabela 3 à variável tabela3
tabela3 <- read.csv("tabela_3.csv")
View(tabela3)
summary(tabela3)
#ver a média de velocidade de cada categoria
tapply(tabela3$Velocidade, tabela3$Tipo, mean)
#ver quantos carros estavam acima de 80km/h
infracao <- ifelse(tabela3$Velocidade > 80, "multa", "normal")
table(tabela3$Tipo,infracao)
#separando as faixas de velocidade (primeiro valor, maior valor, separar de x em x)
brk <- seq(10,100,10); brk
#criando as classes de velocidades (c é vetor)
classes <- c('10-19','20-29','30-39','40-49','50-59','60-69','70-79','80-89','90-100')
tab.frequencia <- table(cut(tabela3$Velocidade,breaks = brk,right = FALSE, labels = classes))
View(tab.frequencia)
barplot(tab.frequencia,xlab = "Faixa de Velocidades (km/h)", ylab="Frequencia", col = '#69b3a2')
library(readr)
tabela4 <- read_csv('tabela_4A.csv')
View(tabela4)
tabela4$media_velocidades <- c(19/2, (29+20)/2,(39+30)/2, (49+40)/2, (59+50)/2, (69+60)/2, (79+70)/2,(89+80)/2, (99+90)/2, (109+100)/2, (119+110)/2, (129+120)/2, (139+130)/2, (199+140)/2)
nlinhas <- nrow(tabela4);nlinhas
tabela4$SomavFreq <- 0
for(i in 1:nlinhas){tabela4$SomavFreq[i] <- sum(tabela4$'jan/17'[i]*tabela4$media_velocidades[i])}
Njan17 = sum(tabela4$'jan/17')
Media_Jan17 = sum(tabela4$SomavFreq)/Njan17;Media_Jan17
tabela4$SS <- 0
for(i in 1:nlinhas){tabela4$SS[i] <- sum((tabela4$media_velocidades[i] - Media_Jan17)^2*tabela4$'jan/17'[i])}
variancia <- sum(tabela4$SS)/(Njan17-1);variancia
desvio_padrao <- sqrt(variancia) ;desvio_padrao
faixas <- c("1-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-109","110-119","120-129","130-139","140-199")
barplot(tabela4$'jan/17', main = "Distribuicao de velocidades",xlab = "Faixa de Velocidades (km/h)",ylab="Frequencia",col="darkred",names.arg = faixas)
library(readr)
tabela4 <- read_csv('tabela_4A.csv')
View(tabela4)
tabela4$media_velocidades <- c(19/2, (29+20)/2,(39+30)/2, (49+40)/2, (59+50)/2, (69+60)/2, (79+70)/2,(89+80)/2, (99+90)/2, (109+100)/2, (119+110)/2, (129+120)/2, (139+130)/2, (199+140)/2)
nlinhas <- nrow(tabela4);nlinhas
tabela4$SomavFreq <- 0
for(i in 1:nlinhas){tabela4$SomavFreq[i] <- sum(tabela4$'ago/17'[i]*tabela4$media_velocidades[i])}
Njan17 = sum(tabela4$'ago/17')
Media_Ago17 = sum(tabela4$SomavFreq)/Nago17;Media_Ago17
library(readr)
tabela4 <- read_csv('tabela_4A.csv')
View(tabela4)
tabela4$media_velocidades <- c(19/2, (29+20)/2,(39+30)/2, (49+40)/2, (59+50)/2, (69+60)/2, (79+70)/2,(89+80)/2, (99+90)/2, (109+100)/2, (119+110)/2, (129+120)/2, (139+130)/2, (199+140)/2)
nlinhas <- nrow(tabela4);nlinhas
tabela4$SomavFreq <- 0
for(i in 1:nlinhas){tabela4$SomavFreq[i] <- sum(tabela4$'ago/17'[i]*tabela4$media_velocidades[i])}
NAgo17 = sum(tabela4$'ago/17')
Media_Ago17 = sum(tabela4$SomavFreq)/Nago17;Media_Ago17
tabela4 <- read_csv('tabela_4A.csv')
View(tabela4)
tabela4$media_velocidades <- c(19/2, (29+20)/2,(39+30)/2, (49+40)/2, (59+50)/2, (69+60)/2, (79+70)/2,(89+80)/2, (99+90)/2, (109+100)/2, (119+110)/2, (129+120)/2, (139+130)/2, (199+140)/2)
nlinhas <- nrow(tabela4);nlinhas
tabela4$SomavFreq <- 0
for(i in 1:nlinhas){tabela4$SomavFreq[i] <- sum(tabela4$'ago/17'[i]*tabela4$media_velocidades[i])}
Nago17 = sum(tabela4$'ago/17')
Media_Ago17 = sum(tabela4$SomavFreq)/Nago17;Media_Ago17
tabela4$SS <- 0
for(i in 1:nlinhas){tabela4$SS[i] <- sum((tabela4$media_velocidades[i] - Media_Ago17)^2*tabela4$'ago/17'[i])}
variancia <- sum(tabela4$SS)/(Nago17-1);variancia
desvio_padrao <- sqrt(variancia) ;desvio_padrao
faixas <- c("1-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-109","110-119","120-129","130-139","140-199")
barplot(tabela4$'ago/17', main = "Distribuicao de velocidades",xlab = "Faixa de Velocidades (km/h)",ylab="Frequencia",col="darkred",names.arg = faixas)
# Associacao do arquivo com a tabela4
tabela4 <- read_csv('tabela_4A.csv')
View(tabela4)
# criacao de uma coluna (vetor) com a media das velocidades dos intervalos
tabela4$media_velocidades <- c(19/2, (29+20)/2,(39+30)/2, (49+40)/2, (59+50)/2, (69+60)/2, (79+70)/2,(89+80)/2, (99+90)/2, (109+100)/2, (119+110)/2, (129+120)/2, (139+130)/2, (199+140)/2)
# contagem do numero de linhas da tabela na variavel nlinhas
nlinhas <- nrow(tabela4);nlinhas
# criacao da coluna que representa o  somatario da frequencia vezes a media das velocidades
tabela4$SomavFreq <- 0
for(i in 1:nlinhas){tabela4$SomavFreq[i] <- sum(tabela4$'jan/17'[i]*tabela4$media_velocidades[i])}
# soma de todas as frequencias, representando o numero N
Njan17 = sum(tabela4$'jan/17')
# Calculo da media das frequencias
Media_Jan17 = sum(tabela4$SomavFreq)/Njan17;Media_Jan17
# Soma ao quadrado dos erros
tabela4$SS <- 0
for(i in 1:nlinhas){tabela4$SS[i] <- sum((tabela4$media_velocidades[i] - Media_Jan17)^2*tabela4$'jan/17'[i])}
# variancia
variancia <- sum(tabela4$SS)/(Njan17-1);variancia
# desvio padrao
desvio_padrao <- sqrt(variancia) ;desvio_padrao
#gráfico
faixas <- c("1-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-109","110-119","120-129","130-139","140-199")
barplot(tabela4$'jan/17', main = "Distribuicao de velocidades",xlab = "Faixa de Velocidades (km/h)",ylab="Frequencia",col="darkred",names.arg = faixas)
library(readr)
faixas <- c("1-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-109","110-119","120-129","130-139","140-199")
barplot(tabela4$jan17, main = "Distribuicao de velocidades",xlab = "Faixa de Velocidades (km/h)",ylab="Frequencia",col="darkred",names.arg = faixas)
par(new = TRUE)
x <- seq(0,200, by = 1)
y <- dnorm(x, mean = 69.3093, sd = 6.4445)
plot(x,y, xlab = NA ,ylab= NA, type = 'p', axes = FALSE, col = 'darkgreen')
faixas <- c("1-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-109","110-119","120-129","130-139","140-199")
barplot(tabela4$jan17, main = "Distribuicao de velocidades",xlab = "Faixa de Velocidades (km/h)",ylab="Frequencia",col="darkred",names.arg = faixas)
par(new = TRUE)
x <- seq(0,200, by = 1)
y <- dnorm(x, mean = 69.3093, sd = 6.4445)
plot(x,y, xlab = NA ,ylab= NA, type = 'p', axes = FALSE, col = 'darkgreen')
tabela4 <- read_csv('tabela_4A.csv')
View(tabela4)
tabela4$media_velocidades <- c(19/2, (29+20)/2,(39+30)/2, (49+40)/2, (59+50)/2, (69+60)/2, (79+70)/2,(89+80)/2, (99+90)/2, (109+100)/2, (119+110)/2, (129+120)/2, (139+130)/2, (199+140)/2)
nlinhas <- nrow(tabela4);nlinhas
tabela4$SomavFreq <- 0
for(i in 1:nlinhas){tabela4$SomavFreq[i] <- sum(tabela4$'ago/17'[i]*tabela4$media_velocidades[i])}
Nago17 = sum(tabela4$'ago/17')
Media_Ago17 = sum(tabela4$SomavFreq)/Nago17;Media_Ago17
tabela4$SS <- 0
for(i in 1:nlinhas){tabela4$SS[i] <- sum((tabela4$media_velocidades[i] - Media_Ago17)^2*tabela4$'ago/17'[i])}
variancia <- sum(tabela4$SS)/(Nago17-1);variancia
desvio_padrao <- sqrt(variancia) ;desvio_padrao
faixas <- c("1-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-109","110-119","120-129","130-139","140-199")
barplot(tabela4$'ago/17', main = "Distribuicao de velocidades",xlab = "Faixa de Velocidades (km/h)",ylab="Frequencia",col="darkred",names.arg = faixas)
tabela4 <- read_csv('tabela_4A.csv')
View(tabela4)
tabela4$media_velocidades <- c(19/2, (29+20)/2,(39+30)/2, (49+40)/2, (59+50)/2, (69+60)/2, (79+70)/2,(89+80)/2, (99+90)/2, (109+100)/2, (119+110)/2, (129+120)/2, (139+130)/2, (199+140)/2)
nlinhas <- nrow(tabela4);nlinhas
tabela4$SomavFreq <- 0
for(i in 1:nlinhas){tabela4$SomavFreq[i] <- sum(tabela4$'ago/17'[i]*tabela4$media_velocidades[i])}
Nago17 = sum(tabela4$'ago/17')
Media_Ago17 = sum(tabela4$SomavFreq)/Nago17;Media_Ago17
tabela4$SS <- 0
for(i in 1:nlinhas){tabela4$SS[i] <- sum((tabela4$media_velocidades[i] - Media_Ago17)^2*tabela4$'ago/17'[i])}
variancia <- sum(tabela4$SS)/(Nago17-1);variancia
desvio_padrao <- sqrt(variancia) ;desvio_padrao
faixas <- c("1-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-109","110-119","120-129","130-139","140-199")
barplot(tabela4$'ago/17', main = "Distribuicao de velocidades",xlab = "Faixa de Velocidades (km/h)",ylab="Frequencia",col="darkred",names.arg = faixas)
par(new = TRUE)
x <- seq(0,200, by = 1)
y <- dnorm(x, mean = 67.27037, sd = 6.732398)
plot(x,y, xlab = NA ,ylab= NA, type = 'p', axes = FALSE, col = 'darkgreen')
tabela4 <- read_csv('tabela_4A.csv')
View(tabela4)
tabela4$media_velocidades <- c(19/2, (29+20)/2,(39+30)/2, (49+40)/2, (59+50)/2, (69+60)/2, (79+70)/2,(89+80)/2, (99+90)/2, (109+100)/2, (119+110)/2, (129+120)/2, (139+130)/2, (199+140)/2)
nlinhas <- nrow(tabela4);nlinhas
tabela4$SomavFreq <- 0
for(i in 1:nlinhas){tabela4$SomavFreq[i] <- sum(tabela4$'ago/17'[i]*tabela4$media_velocidades[i])}
Nago17 = sum(tabela4$'ago/17')
Media_Ago17 = sum(tabela4$SomavFreq)/Nago17;Media_Ago17
tabela4$SS <- 0
for(i in 1:nlinhas){tabela4$SS[i] <- sum((tabela4$media_velocidades[i] - Media_Ago17)^2*tabela4$'ago/17'[i])}
variancia <- sum(tabela4$SS)/(Nago17-1);variancia
desvio_padrao <- sqrt(variancia) ;desvio_padrao
faixas <- c("1-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-109","110-119","120-129","130-139","140-199")
barplot(tabela4$'ago/17', main = "Distribuicao de velocidades",xlab = "Faixa de Velocidades (km/h)",ylab="Frequencia",col="darkred",names.arg = faixas)
par(new = TRUE)
x <- seq(0,200, by = 1)
y <- dnorm(x, mean = Media_Ago17, sd = desvio_padrao)
plot(x,y, xlab = NA ,ylab= NA, type = 'p', axes = FALSE, col = 'darkgreen')
tabela4 <- read_csv('tabela_4A.csv')
View(tabela4)
tabela4$media_velocidades <- c(19/2, (29+20)/2,(39+30)/2, (49+40)/2, (59+50)/2, (69+60)/2, (79+70)/2,(89+80)/2, (99+90)/2, (109+100)/2, (119+110)/2, (129+120)/2, (139+130)/2, (199+140)/2)
nlinhas <- nrow(tabela4);nlinhas
tabela4$SomavFreq <- 0
for(i in 1:nlinhas){tabela4$SomavFreq[i] <- sum(tabela4$'ago/17'[i]*tabela4$media_velocidades[i])}
Nago17 = sum(tabela4$'ago/17')
Media_Ago17 = sum(tabela4$SomavFreq)/Nago17;Media_Ago17
tabela4$SS <- 0
for(i in 1:nlinhas){tabela4$SS[i] <- sum((tabela4$media_velocidades[i] - Media_Ago17)^2*tabela4$'ago/17'[i])}
variancia <- sum(tabela4$SS)/(Nago17-1);variancia
desvio_padrao <- sqrt(variancia) ;desvio_padrao
faixas <- c("1-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-109","110-119","120-129","130-139","140-199")
barplot(tabela4$'ago/17', main = "Distribuicao de velocidades",xlab = "Faixa de Velocidades (km/h)",ylab="Frequencia",col="darkred",names.arg = faixas)
par(new = TRUE)
x <- seq(0,200, by = 1)
y <- dnorm(x, mean = 67.27037, sd = 6.732398)
plot(x,y, xlab = NA ,ylab= NA, type = 'p', axes = FALSE, col = 'darkgreen')
tabela4 <- read_csv('tabela_4A.csv')
View(tabela4)
tabela4$media_velocidades <- c(19/2, (29+20)/2,(39+30)/2, (49+40)/2, (59+50)/2, (69+60)/2, (79+70)/2,(89+80)/2, (99+90)/2, (109+100)/2, (119+110)/2, (129+120)/2, (139+130)/2, (199+140)/2)
nlinhas <- nrow(tabela4);nlinhas
tabela4$SomavFreq <- 0
for(i in 1:nlinhas){tabela4$SomavFreq[i] <- sum(tabela4$'ago/17'[i]*tabela4$media_velocidades[i])}
Nago17 = sum(tabela4$'ago/17')
Media_Ago17 = sum(tabela4$SomavFreq)/Nago17;Media_Ago17
tabela4$SS <- 0
for(i in 1:nlinhas){tabela4$SS[i] <- sum((tabela4$media_velocidades[i] - Media_Ago17)^2*tabela4$'ago/17'[i])}
variancia <- sum(tabela4$SS)/(Nago17-1);variancia
desvio_padrao <- sqrt(variancia) ;desvio_padrao
faixas <- c("1-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100-109","110-119","120-129","130-139","140-199")
barplot(tabela4$'ago/17', main = "Marcos Veloso - Agosto",xlab = "Faixa de Velocidades (km/h)",ylab="Frequencia",col="darkred",names.arg = faixas)
par(new = TRUE)
x <- seq(0,200, by = 1)
y <- dnorm(x, mean = Media_Ago17, sd = desvio_padrao)
plot(x,y, xlab = NA ,ylab= NA, type = 'p', axes = FALSE, col = 'darkgreen')
